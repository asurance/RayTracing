!function(t){var e={};function o(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(r,i,function(e){return t[e]}.bind(null,i));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=3)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(2),i=function(){function t(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this.x=t,this.y=e,this.z=o}return t.prototype.reset=function(){return this.x=this.y=this.z=0,this},t.prototype.set=function(t,e,o){return this.x=t,this.y=e,this.z=o,this},t.prototype.clone=function(e){return void 0===e&&(e=t.Pool.create()),e.x=this.x,e.y=this.y,e.z=this.z,e},t.prototype.length=function(){return Math.hypot(this.x,this.y,this.z)},t.prototype.sqauredLength=function(){return this.dot(this)},t.prototype.normalize=function(e){void 0===e&&(e=t.Pool.create());var o=this.length();return o>0&&this.multiScale(1/o,e),e},t.prototype.add=function(e,o){return void 0===o&&(o=t.Pool.create()),o.x=this.x+e.x,o.y=this.y+e.y,o.z=this.z+e.z,o},t.prototype.multiScale=function(e,o){return void 0===o&&(o=t.Pool.create()),o.x=this.x*e,o.y=this.y*e,o.z=this.z*e,o},t.prototype.multiVec3=function(e,o){return void 0===o&&(o=t.Pool.create()),o.x=this.x*e.x,o.y=this.y*e.y,o.z=this.z*e.z,o},t.prototype.reciprocal=function(e){return void 0===e&&(e=t.Pool.create()),e.x=1/e.x,e.y=1/e.y,e.z=1/e.z,e},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(e,o){void 0===o&&(o=t.Pool.create());var r=this.y*e.z-this.z*e.y,i=this.z*e.x-this.x*e.z,n=this.x*e.y-this.y*e.x;return o.x=r,o.y=i,o.z=n,o},t.prototype.toString=function(){return"("+this.x+","+this.y+","+this.z+")"},t.Pool=new r.RecyclablePool(t,"Vector3"),t}();e.Vector3=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(2),i=function(){function t(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this.r=t,this.g=e,this.b=o}return t.prototype.reset=function(){return this.r=this.g=this.b=0,this},t.prototype.clone=function(e){return void 0===e&&(e=t.Pool.create()),e.r=this.r,e.g=this.g,e.b=this.b,e},t.prototype.set=function(t,e,o){return this.r=t,this.g=e,this.b=o,this},t.prototype.render=function(t,e,o){var r=o*t.width+e<<2;t.data[r]=Math.floor(255.99*this.r),t.data[r+1]=Math.floor(255.99*this.g),t.data[r+2]=Math.floor(255.99*this.b),t.data[r+3]=255},t.Pool=new r.RecyclablePool(t,"Color"),t}();e.Color=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){void 0===e&&(e=""),this.pool=[],this.tidyPool=[],this.isTidy=!1,this.count=0,this.logCount="",this.template=t,this.logCount=e}return t.prototype.create=function(){var t=this.pool.pop();return t?t.reset():(t=new this.template,this.logCount&&(this.count++,console.log(this.logCount+":"+this.count))),this.isTidy&&this.tidyPool.push(t),t},t.prototype.reUse=function(t){this.pool.push(t)},t.prototype.tidy=function(t,e){var o;void 0===e&&(e=this.create()),this.isTidy=!0;var r=t();return this.isTidy=!1,e=r.clone(e),(o=this.pool).push.apply(o,this.tidyPool),this.tidyPool.length=0,e},t}();e.RecyclablePool=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(4),i=o(5),n=o(7),u=o(0),c=o(8),s=o(9),l=o(10),a=o(11),h=o(1),d=document.createElement("canvas");d.width=r.global.WIDTH,d.height=r.global.HEIGHT,document.body.appendChild(d);var f=d.getContext("2d"),p=new l.Normal,y=new a.Pure(h.Color.Pool.create().set(1,1,1)),v=new c.World([new s.RTObject(new n.Sphere(u.Vector3.Pool.create().set(0,0,-1),.5),p),new s.RTObject(new n.Sphere(u.Vector3.Pool.create().set(1,-1,-1),.5),y)]),P=new i.Camera(u.Vector3.Pool.create().set(0,0,0),u.Vector3.Pool.create().set(0,0,-1),u.Vector3.Pool.create().set(0,1,0),90,r.global.WIDTH,r.global.HEIGHT),m={t:0,position:u.Vector3.Pool.create(),normal:u.Vector3.Pool.create()};P.render((function(t){return v.hitTest(t,m)})),f.putImageData(P.imageData,0,0)},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.global={WIDTH:201,HEIGHT:101}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(0),i=o(1),n=o(6),u=function(){function t(t,e,o,i,n,u){var c=this;this.origin=t,this.width=n,this.height=u,this.imageData=new ImageData(n,u);var s=i*Math.PI/180,l=Math.tan(s/2),a=n/u*l,h=r.Vector3.Pool.tidy((function(){return t.add(e.multiScale(-1)).normalize()})),d=r.Vector3.Pool.tidy((function(){return o.cross(h).normalize()})),f=h.cross(d);this.lowerLeftCorner=r.Vector3.Pool.tidy((function(){return c.origin.add(d.multiScale(a).add(f.multiScale(l)).add(h).multiScale(-1))})),this.horizontal=d.multiScale(2*a),this.vertical=f.multiScale(2*l)}return t.prototype.render=function(t){for(var e=this,o=new n.Ray(this.origin,r.Vector3.Pool.create()),u=function(n){for(var u=function(u){r.Vector3.Pool.reUse(o.direction),o.direction=r.Vector3.Pool.tidy((function(){return e.lowerLeftCorner.add(e.horizontal.multiScale(n/(e.width-1)).add(e.vertical.multiScale(1-u/(e.height-1))))})),o.u=n,o.v=u;var s=t(o);s.render(c.imageData,n,u),i.Color.Pool.reUse(s)},s=0;s<c.height;s++)u(s)},c=this,s=0;s<this.width;s++)u(s);r.Vector3.Pool.reUse(o.direction)},t}();e.Camera=u},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(0),i=function(){function t(t,e){this.u=0,this.v=0,this.origin=t,this.direction=e}return t.prototype.getPointAtT=function(t,e){var o=this;return void 0===e&&(e=r.Vector3.Pool.create()),r.Vector3.Pool.tidy((function(){return o.origin.add(o.direction.multiScale(t))}),e)},t}();e.Ray=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(0),i=function(){function t(t,e){this.center=t.clone(),this.radius=e}return t.prototype.hitTest=function(t,e,o,i){var n=this,u=r.Vector3.Pool.tidy((function(){return t.origin.add(n.center.multiScale(-1))})),c=t.direction.sqauredLength(),s=u.dot(t.direction),l=u.sqauredLength()-this.radius*this.radius;if(r.Vector3.Pool.reUse(u),s*s-c*l){var a=Math.sqrt(s*s-c*l),h=(-s-a)/c;if(h<o&&h>e)return i.t=h,i.position=t.getPointAtT(h,i.position),i.normal=r.Vector3.Pool.tidy((function(){return i.position.add(n.center.multiScale(-1)).multiScale(1/n.radius)}),i.normal),!0;if((h=(-s+a)/c)<o&&h>e)return i.t=h,i.position=t.getPointAtT(h,i.position),i.normal=r.Vector3.Pool.tidy((function(){return i.position.add(n.center.multiScale(-1)).multiScale(1/n.radius)}),i.normal),!0}return!1},t}();e.Sphere=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(1),i=function(){function t(t){this.objs=t}return t.prototype.hitTest=function(t,e){var o=null,i=1/0;return this.objs.forEach((function(r,n){r.shape.hitTest(t,0,i,e)&&(o=n,i=e.t)})),null!==o?this.objs[o].mat.scatter(t,e):r.Color.Pool.create().set(0,0,0)},t}();e.World=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e){this.shape=t,this.mat=e};e.RTObject=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(1),i=function(){function t(){}return t.prototype.scatter=function(t,e){return r.Color.Pool.create().set(e.normal.x,e.normal.y,e.normal.z)},t}();e.Normal=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.color=t.clone()}return t.prototype.scatter=function(){return this.color.clone()},t}();e.Pure=r}]);