!function(t){var e={};function o(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(i,r,function(e){return t[e]}.bind(null,r));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=3)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(2),r=function(){function t(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this.x=t,this.y=e,this.z=o}return t.prototype.reset=function(){return this.x=this.y=this.z=0,this},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},t.prototype.set=function(t,e,o){return this.x=t,this.y=e,this.z=o,this},t.prototype.clone=function(e){return void 0===e&&(e=t.Pool.create()),e.x=this.x,e.y=this.y,e.z=this.z,e},t.prototype.length=function(){return Math.hypot(this.x,this.y,this.z)},t.prototype.sqauredLength=function(){return this.dot(this)},t.prototype.normalize=function(e){void 0===e&&(e=t.Pool.create());var o=this.length();return o>0&&this.multiScale(1/o,e),e},t.prototype.add=function(e,o){return void 0===o&&(o=t.Pool.create()),o.x=this.x+e.x,o.y=this.y+e.y,o.z=this.z+e.z,o},t.prototype.multiScale=function(e,o){return void 0===o&&(o=t.Pool.create()),o.x=this.x*e,o.y=this.y*e,o.z=this.z*e,o},t.prototype.multiVec3=function(e,o){return void 0===o&&(o=t.Pool.create()),o.x=this.x*e.x,o.y=this.y*e.y,o.z=this.z*e.z,o},t.prototype.reciprocal=function(e){return void 0===e&&(e=t.Pool.create()),e.x=1/e.x,e.y=1/e.y,e.z=1/e.z,e},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(e,o){void 0===o&&(o=t.Pool.create());var i=this.y*e.z-this.z*e.y,r=this.z*e.x-this.x*e.z,n=this.x*e.y-this.y*e.x;return o.x=i,o.y=r,o.z=n,o},t.prototype.toString=function(){return"("+this.x+","+this.y+","+this.z+")"},t.Pool=new i.RecyclablePool(t,"Vector3"),t}();e.Vector3=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(2),r=function(){function t(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this.r=t,this.g=e,this.b=o}return t.prototype.reset=function(){return this.r=this.g=this.b=0,this},t.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},t.prototype.set=function(t,e,o){return this.r=t,this.g=e,this.b=o,this},t.prototype.render=function(t,e,o){var i=o*t.width+e<<2;t.data[i]=Math.floor(255.99*this.r),t.data[i+1]=Math.floor(255.99*this.g),t.data[i+2]=Math.floor(255.99*this.b),t.data[i+3]=255},t.Pool=new i.RecyclablePool(t,"Color"),t}();e.Color=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){void 0===e&&(e=""),this.pool=[],this.tidyPool=[],this.isTidy=!1,this.count=0,this.logCount="",this.template=t,this.logCount=e}return t.prototype.create=function(){var t=this.pool.pop();return t?t.reset():(t=new this.template,this.logCount&&(this.count++,console.log(this.logCount+":"+this.count))),this.isTidy&&this.tidyPool.push(t),t},t.prototype.reUse=function(t){this.pool.push(t)},t.prototype.tidy=function(t,e){var o;void 0===e&&(e=this.create()),this.isTidy=!0;var i=t();return this.isTidy=!1,e.copy(i),(o=this.pool).push.apply(o,this.tidyPool),this.tidyPool.length=0,e},t}();e.RecyclablePool=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=o(5),n=o(7),u=o(0),s=o(8),c=o(9),a=o(10),l=document.createElement("canvas");l.width=i.global.WIDTH,l.height=i.global.HEIGHT,document.body.appendChild(l);var h=l.getContext("2d"),d=new a.Normal,f=new s.World([new c.RTObject(new n.Sphere(u.Vector3.Pool.create().set(0,0,-1),.5),d)]),p=new r.Camera(u.Vector3.Pool.create().set(0,0,0),u.Vector3.Pool.create().set(0,0,-1),u.Vector3.Pool.create().set(0,1,0),90,i.global.WIDTH,i.global.HEIGHT),y={t:0,position:u.Vector3.Pool.create(),normal:u.Vector3.Pool.create()};p.render((function(t){return f.hitTest(t,y)})),h.putImageData(p.imageData,0,0)},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.global={WIDTH:201,HEIGHT:101}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=o(1),n=o(6),u=function(){function t(t,e,o,r,n,u){var s=this;this.origin=t,this.width=n,this.height=u,this.imageData=new ImageData(n,u);var c=r*Math.PI/180,a=Math.tan(c/2),l=n/u*a,h=i.Vector3.Pool.tidy((function(){return t.add(e.multiScale(-1)).normalize()})),d=i.Vector3.Pool.tidy((function(){return o.cross(h).normalize()})),f=h.cross(d);this.lowerLeftCorner=i.Vector3.Pool.tidy((function(){return s.origin.add(d.multiScale(l).add(f.multiScale(a)).add(h).multiScale(-1))})),this.horizontal=d.multiScale(2*l),this.vertical=f.multiScale(2*a)}return t.prototype.render=function(t){for(var e=this,o=new n.Ray(this.origin,i.Vector3.Pool.create()),u=function(n){for(var u=function(u){i.Vector3.Pool.reUse(o.direction),o.direction=i.Vector3.Pool.tidy((function(){return e.lowerLeftCorner.add(e.horizontal.multiScale(n/(e.width-1)).add(e.vertical.multiScale(1-u/(e.height-1))))})),o.u=n,o.v=u;var c=t(o);c.render(s.imageData,n,u),r.Color.Pool.reUse(c)},c=0;c<s.height;c++)u(c)},s=this,c=0;c<this.width;c++)u(c);i.Vector3.Pool.reUse(o.direction)},t}();e.Camera=u},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=function(){function t(t,e){this.u=0,this.v=0,this.origin=t,this.direction=e}return t.prototype.getPointAtT=function(t,e){var o=this;return void 0===e&&(e=i.Vector3.Pool.create()),i.Vector3.Pool.tidy((function(){return o.origin.add(o.direction.multiScale(t))}),e)},t}();e.Ray=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=function(){function t(t,e){this.center=t,this.radius=e}return t.prototype.hitTest=function(t,e,o,r){var n=this,u=i.Vector3.Pool.tidy((function(){return t.origin.add(n.center.multiScale(-1))})),s=t.direction.sqauredLength(),c=u.dot(t.direction),a=u.sqauredLength()-this.radius*this.radius;if(i.Vector3.Pool.reUse(u),c*c-s*a){var l=Math.sqrt(c*c-s*a),h=(-c-l)/s;if(h<o&&h>e)return r.t=h,r.position=t.getPointAtT(h,r.position),r.normal=i.Vector3.Pool.tidy((function(){return r.position.add(n.center.multiScale(-1)).multiScale(1/n.radius)}),r.normal),!0;if((h=(-c+l)/s)<o&&h>e)return r.t=h,r.position=t.getPointAtT(h,r.position),r.normal=i.Vector3.Pool.tidy((function(){return r.position.add(n.center.multiScale(-1)).multiScale(1/n.radius)}),r.normal),!0}return!1},t}();e.Sphere=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=function(){function t(t){this.objs=t}return t.prototype.hitTest=function(t,e){var o=null,r=1/0;return this.objs.forEach((function(i,n){i.shape.hitTest(t,0,r,e)&&(o=n,r=e.t)})),null!==o?this.objs[o].mat.scatter(t,e):i.Color.Pool.create().set(0,0,0)},t}();e.World=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){this.shape=t,this.mat=e};e.RTObject=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=function(){function t(){}return t.prototype.scatter=function(t,e){return i.Color.Pool.create().set(e.normal.x,e.normal.y,e.normal.z)},t}();e.Normal=r}]);